---
layout: post
title: Express 入门
---

{{ page.title }}
================

安装
---------------------------
首先安装 express
	$ npm install express -g

新建项目
	$ express test -e 
-e 使用 ejs 模板, 默认是 jade 模板

案例
--------------
1. hello world

	app.get('/', function (req, res) {
	    res.send('Hello, world');
	});

2. mongodb 增查改删




	var mongoose = require( 'mongoose' );
	var Todo     = mongoose.model( 'Todo' );

	exports.index = function ( req, res, next ){
	  
	    Todo.find(function ( err, todos ){
	      if( err ) return next( err );

	      res.render( 'index', {
		  title : 'Express Todo Example',
		  todos : todos
	      });
	    });
	};

	exports.create = function ( req, res, next ){
	    
	    var todo = new Todo({
	      content    : req.body.content,
	      updated_at : Date.now()
	   });
	   
	  todo.save( function ( err, todo, count ){
	    if( err ) return next( err );

	    res.redirect( '/' );
	  });
	};

	exports.destroy = function ( req, res, next ){
	  Todo.findById( req.params.id, function ( err, todo ){
	 
	    todo.remove( function ( err, todo ){
	      if( err ) return next( err );

	      res.redirect( '/' );
	    });
	  });
	};

	exports.edit = function( req, res, next ){


	  Todo.find( function ( err, todos ){
	      if( err ) return next( err );

	      res.render( 'edit', {
		title   : 'Express Todo Example',
		todos   : todos,
		current : req.params.id
	      });
	    });
	};

	exports.update = function( req, res, next ){
	  Todo.findById( req.params.id, function ( err, todo ){
	  
	    todo.content    = req.body.content;
	    todo.updated_at = Date.now();
	    todo.save( function ( err, todo, count ){
	      if( err ) return next( err );

	      res.redirect( '/' );
	    });
	  });
	};


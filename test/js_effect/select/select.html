<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<style type="text/css">
<!--
* { margin:0; padding:0}
body { font-size:12px; padding-left:20px}
ul { list-style:none}
#friendship { background: url(images/select.gif) no-repeat; height: 26px;line-height:26px; width: 146px; border:none; padding-left:15px; text-align:left;cursor:pointer;font-size:12px}
#select {overflow:hidden;width: 144px; line-height:22px;border: 1px solid #e6e6e6; display:none}
#select ul li{display:inline}
#select ul li a { display:block;width:131px;padding-left: 15px; color:#000; text-decoration:none}
#select ul li a:hover { background:#e6e6e6; }
-->
</style>
</head>
<body>
<input id="friendship" type="text"  value="下拉列表" readonly="true"/>
<div id="select">
  <ul>
    <li><a href="#">下拉列表1</a></li>
    <li><a href="#">下拉列表2</a></li>
    <li><a href="#">下拉列表3</a></li>
    <li><a href="#">下拉列表4</a></li>
    <li><a href="#">下拉列表5</a></li>
  </ul>
</div>
<script>
var imgSelect=(function(){
	var check=0;
	var obj=document.getElementById("friendship");
	var selectObj=document.getElementById("select");
	//取得元素位置
	function getPosition(elem){
	  var x = 0;
	  var y = 0;
	  while (elem != null){
		x += elem.offsetLeft;
		y += elem.offsetTop;
		elem = elem.offsetParent;
	  }
	  return [x, y];
	}
	return{
		init:function(){
			//展开选项
			document.getElementById("friendship").onclick=function(e){imgSelect.show(e);}
			
			//页面其它地方点击消失
			document.documentElement.onclick=function(){imgSelect.hide();}

			//选项添加点击事件
			var selectItems=selectObj.getElementsByTagName("a");
			for(var i=0;i<selectItems.length;i++){
				selectItems[i].onclick=function(){
					imgSelect.select(this);
					return false;
				}
			}
		},
		 show:function(event){
			check=1;
			selectObj.style.display="block";
			selectObj.style.left=getPosition(obj)[0]+"px";
			selectObj.style.top=getPosition(obj)[1]+obj.offsetHeight+"px";
			(event || window.event).cancelBubble=true;//阻止传递
		},
		select:function(text){
			obj.value=text.innerHTML;
			selectObj.style.display="none";
		},
		hide:function(){
			if(check=1){
				selectObj.style.display="none";
			}
		}
	}
})()

imgSelect.init();
</script>
</body>
</html>
